http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-2692

--- a/net/socket.c
+++ b/net/socket.c
@@ -607,6 +607,9 @@ ssize_t sock_sendpage(struct file *file,
 	if (more)
 		flags |= MSG_MORE;
 
+	if (!sock->ops->sendpage)
+		return sock_no_sendpage(sock, page, offset, size, flags);
+
 	return sock->ops->sendpage(sock, page, offset, size, flags);
 }
 
